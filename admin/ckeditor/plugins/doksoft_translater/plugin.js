var JSONP=function(c){function f(j,l){function i(){try{delete c[k];}catch(m){c[k]=null;}d.removeChild(h);b[j]=[arguments[0]];try{l.apply(this,arguments);}catch(m){}}if(!b[j]){var k=e+g++,h=a.createElement("script");h.setAttribute("async",true);c[k]=i;d.insertBefore(h,d.lastChild).src=j+"="+k;}else{setTimeout(function(){l.apply(this,b[j]);},200);}}var g=0,e="__JSONP__",a=c.document,b={},d=a.documentElement;return f;}(this);CKEDITOR.plugins.add("doksoft_translater",{lang:"en,ru",icons:"doksoft_translater,doksoft_translater_settings,doksoft_translater_reverse",init:function(e){var m={"_":{},"last":{},"now":{}};if(!e.lang.doksoft_translater){e.lang.doksoft_translater={alert_title:"alert",alert_replace_button:"replace",alert_append_button:"append",direction:"The direction of translation",service:"Service",yandex_translate_api:"Yandex Translate API",bing_translate_api:"Bing Translate API",googleopts_translate_api:"Google Translate API",assign_hotkeys:"Assign hotkeys",what_to_do:"What to do",inline_replace:"Inline replace",inline_append:"Inline append",show_dialog:"Show dialog",translate:"Translate",translate_settings:"Translate Settings",translate_reverse:"Translate Reverse",langs:{"ru":"Russian","en":"English","pl":"Polish","hu":"Hungarian","uk":"Ukrainian","de":"German","fr":"French","be":"Belarusian","sq":"Albanian","es":"Spanish","it":"Italian","hy":"Armenian","da":"Danish","pt":"Portuguese","sk":"Slovak","sl":"Slovenian","nl":"Dutch","bg":"Bulgarian","ca":"Catalan","hr":"Croatian","cs":"Czech","el":"Greek","no":"Norwegian","mk":"Macedonian","sv":"Swedish","fi":"Finnish","et":"Estonian","lv":"Latvian","lt":"Lithuanian","tr":"Turkish","ro":"Romanian","sr":"Serbian","az":"Azerbaijani"},};}m.now={doksoft_yandex_key:e.config.doksoft_yandex_key?e.config.doksoft_yandex_key:"trnsl.1.1.20130819T112450Z.e14ecaa487166a0d.86f8dd0967b040960bdc710ece4be7420e88ddb2",doksoft_translater_default_from_language:e.config.doksoft_translater_default_from_language?e.config.doksoft_translater_default_from_language:"en",doksoft_translater_default_to_language:e.config.doksoft_translater_default_to_language?e.config.doksoft_translater_default_to_language:"de",doksoft_ontranslate:e.config.doksoft_ontranslate?e.config.doksoft_ontranslate:"replace",doksoft_hotkeys:e.config.doksoft_hotkeys?e.config.doksoft_hotkeys:CKEDITOR.CTRL+13,doksoft_service:e.config.doksoft_service?e.config.doksoft_service:"yandex",doksoft_bing_interval_update_token:e.config.doksoft_bing_interval_update_token?e.config.doksoft_bing_interval_update_token:9*60*1000,doksoft_bing_client_id:e.config.doksoft_bing_client_id?e.config.doksoft_bing_client_id:"",doksoft_bing_client_secret:e.config.doksoft_bing_client_secret?e.config.doksoft_bing_client_secret:"",doksoft_keycode:e.config.doksoft_keycode?e.config.doksoft_keycode:"adel",doksoft_version:"1.0.5",doksoft_direction_support:{yandex:["ru-en","ru-pl","ru-hu","ru-uk","ru-de","ru-fr","ru-be","ru-sq","ru-es","ru-it","ru-hy","ru-da","ru-pt","ru-sk","ru-sl","ru-nl","ru-bg","ru-ca","ru-hr","ru-cs","ru-el","ru-no","ru-mk","ru-sv","ru-fi","ru-et","ru-lv","ru-lt","ru-tr","ru-ro","ru-sr","ru-az","en-ru","en-hu","en-uk","en-de","en-fr","en-be","en-sq","en-es","en-it","en-da","en-pt","en-sk","en-sl","en-nl","en-ca","en-cs","en-el","en-no","en-mk","en-sv","en-fi","en-et","en-lv","en-lt","en-tr","pl-ru","pl-uk","pl-be","hu-ru","hu-en","uk-ru","uk-en","uk-pl","uk-de","uk-fr","uk-es","uk-it","uk-bg","uk-cs","uk-tr","uk-ro","uk-sr","de-ru","de-en","de-uk","de-fr","de-be","de-es","de-it","de-tr","fr-ru","fr-en","fr-uk","fr-de","fr-be","be-ru","be-en","be-pl","be-de","be-fr","be-es","be-it","be-bg","be-cs","be-tr","be-ro","be-sr","sq-ru","sq-en","es-ru","es-en","es-uk","es-de","es-be","it-ru","it-en","it-uk","it-de","it-be","hy-ru","da-ru","da-en","pt-ru","pt-en","sk-ru","sk-en","sl-ru","sl-en","nl-ru","nl-en","bg-ru","bg-uk","bg-be","ca-ru","ca-en","hr-ru","cs-ru","cs-en","cs-uk","cs-be","el-ru","el-en","no-ru","no-en","mk-ru","mk-en","sv-ru","sv-en","fi-ru","fi-en","et-ru","et-en","lv-ru","lv-en","lt-ru","lt-en","tr-ru","tr-en","tr-uk","tr-de","tr-be","ro-ru","ro-uk","ro-be","sr-ru","sr-uk","sr-be","az-ru"],bing:["ru-en","ru-pl","ru-hu","ru-uk","ru-de","ru-fr","ru-be","ru-sq","ru-es","ru-it","ru-hy","ru-da","ru-pt","ru-sk","ru-sl","ru-nl","ru-bg","ru-ca","ru-hr","ru-cs","ru-el","ru-no","ru-mk","ru-sv","ru-fi","ru-et","ru-lv","ru-lt","ru-tr","ru-ro","ru-sr","ru-az","en-ru","en-hu","en-uk","en-de","en-fr","en-be","en-sq","en-es","en-it","en-da","en-pt","en-sk","en-sl","en-nl","en-ca","en-cs","en-el","en-no","en-mk","en-sv","en-fi","en-et","en-lv","en-lt","en-tr","pl-ru","pl-uk","pl-be","hu-ru","hu-en","uk-ru","uk-en","uk-pl","uk-de","uk-fr","uk-es","uk-it","uk-bg","uk-cs","uk-tr","uk-ro","uk-sr","de-ru","de-en","de-uk","de-fr","de-be","de-es","de-it","de-tr","fr-ru","fr-en","fr-uk","fr-de","fr-be","be-ru","be-en","be-pl","be-de","be-fr","be-es","be-it","be-bg","be-cs","be-tr","be-ro","be-sr","sq-ru","sq-en","es-ru","es-en","es-uk","es-de","es-be","it-ru","it-en","it-uk","it-de","it-be","hy-ru","da-ru","da-en","pt-ru","pt-en","sk-ru","sk-en","sl-ru","sl-en","nl-ru","nl-en","bg-ru","bg-uk","bg-be","ca-ru","ca-en","hr-ru","cs-ru","cs-en","cs-uk","cs-be","el-ru","el-en","no-ru","no-en","mk-ru","mk-en","sv-ru","sv-en","fi-ru","fi-en","et-ru","et-en","lv-ru","lv-en","lt-ru","lt-en","tr-ru","tr-en","tr-uk","tr-de","tr-be","ro-ru","ro-uk","ro-be","sr-ru","sr-uk","sr-be","az-ru"],google:["ru-en","ru-pl","ru-hu","ru-uk","ru-de","ru-fr","ru-be","ru-sq","ru-es","ru-it","ru-hy","ru-da","ru-pt","ru-sk","ru-sl","ru-nl","ru-bg","ru-ca","ru-hr","ru-cs","ru-el","ru-no","ru-mk","ru-sv","ru-fi","ru-et","ru-lv","ru-lt","ru-tr","ru-ro","ru-sr","ru-az","en-ru","en-hu","en-uk","en-de","en-fr","en-be","en-sq","en-es","en-it","en-da","en-pt","en-sk","en-sl","en-nl","en-ca","en-cs","en-el","en-no","en-mk","en-sv","en-fi","en-et","en-lv","en-lt","en-tr","pl-ru","pl-uk","pl-be","hu-ru","hu-en","uk-ru","uk-en","uk-pl","uk-de","uk-fr","uk-es","uk-it","uk-bg","uk-cs","uk-tr","uk-ro","uk-sr","de-ru","de-en","de-uk","de-fr","de-be","de-es","de-it","de-tr","fr-ru","fr-en","fr-uk","fr-de","fr-be","be-ru","be-en","be-pl","be-de","be-fr","be-es","be-it","be-bg","be-cs","be-tr","be-ro","be-sr","sq-ru","sq-en","es-ru","es-en","es-uk","es-de","es-be","it-ru","it-en","it-uk","it-de","it-be","hy-ru","da-ru","da-en","pt-ru","pt-en","sk-ru","sk-en","sl-ru","sl-en","nl-ru","nl-en","bg-ru","bg-uk","bg-be","ca-ru","ca-en","hr-ru","cs-ru","cs-en","cs-uk","cs-be","el-ru","el-en","no-ru","no-en","mk-ru","mk-en","sv-ru","sv-en","fi-ru","fi-en","et-ru","et-en","lv-ru","lv-en","lt-ru","lt-en","tr-ru","tr-en","tr-uk","tr-de","tr-be","ro-ru","ro-uk","ro-be","sr-ru","sr-uk","sr-be","az-ru"],},};
if(window.localStorage){m.last=JSON.parse(localStorage.getItem("settings.last"));localStorage.setItem("settings.last",JSON.stringify(m.now));}var i=false;if(m.last){for(var r in m.now){if(m.last[r]!=m.now[r]&&(/boolean|number|string/).test(typeof m.last[r])){i=true;break;}}}else{i=true;}e.on("startTokenizer",function(){if(m._.doksoft_service=="bing"){clearInterval(l);var s=function(){JSONP(CKEDITOR.basePath+"plugins/doksoft_translater/bing.php?keycode="+m._.doksoft_keycode+"&client_id="+m._.doksoft_bing_client_id+"&client_secret="+m._.doksoft_bing_client_secret+"&callback",function(t){f=t.token;});};l=setInterval(s,m._.doksoft_bing_interval_update_token);s();}else{clearInterval(l);}});e.on("updateSettings",function(){if(window.localStorage){localStorage.setItem("settings.current",JSON.stringify(m._));}e.fire("startTokenizer");});if(i){m._=m.now;e.fire("updateSettings");}else{m._=JSON.parse(localStorage.getItem("settings.current"));if(!m._){m._=m.now;e.fire("updateSettings");}}e.fire("startTokenizer");var h=0,n=0,k="",o="",f="",l=0;var a=function(t,u){var s=function(w,v){v=v||{};return CKEDITOR.tools.extend({id:t,type:"button",label:t,"class":"cke_dialog_ui_button_ok",onClick:function(x){var y=x.data.dialog;u&&u.apply&&u.apply(this);y.hide();}},v,true);};s.type="button";s.override=function(v){return CKEDITOR.tools.extend(function(w){return s(w,v);},{type:"button"},true);};return s;};CKEDITOR.dialog.add("doksoft_translater_alert",function(s){return{title:s.lang.doksoft_translater.alert_title,minWidth:200,minHeight:70,resizable:false,contents:[{id:"tab22",label:"",title:"",expand:true,padding:0,elements:[{id:"elementId",type:"html",html:"",}]}],buttons:[CKEDITOR.dialog.okButton,a(s.lang.doksoft_translater.alert_replace_button,function(){c(n,o,k);}),a(s.lang.doksoft_translater.alert_append_button,function(){j(n,o,k);}),],onShow:function(){},onOk:function(){},};});var d=[{CTRL:CKEDITOR.CTRL,ALT:CKEDITOR.ALT,SHIFT:CKEDITOR.SHIFT,"CTRL+SHIFT":CKEDITOR.CTRL+CKEDITOR.SHIFT,"CTRL+ALT":CKEDITOR.CTRL+CKEDITOR.ALT,"ALT+SHIFT":CKEDITOR.ALT+CKEDITOR.ALT,"CAPS LOCK":20,"NUM LOCK":144,},{"Q":81,"W":87,"E":69,"R":82,"T":84,"Y":89,"U":85,"I":73,"O":79,"P":80,"[":219,"]":221,"A":65,"S":83,"D":68,"F":70,"G":71,"H":72,"J":74,"K":75,"L":76,";":186,"'":222,"Z":90,"X":88,"C":67,"V":86,"B":66,"N":78,"M":77,",":188,".":190,"/":191,"1":49,"2":50,"3":51,"4":52,"5":53,"6":54,"7":55,"8":56,"9":57,"0":58,"-":59,"=":60,"+":187,"*":106,"Arrow Up":38,"Arrow Down":40,"Arrow Left":37,"Arrow Right":39,"Enter":13,"Esc":27,"Space":32,},];CKEDITOR.dialog.add("doksoft_translater",function(s){return{title:s.lang.doksoft_translater.translate_settings,minWidth:500,minHeight:70,resizable:false,contents:[{id:"tab1",label:"",title:"",expand:true,padding:0,elements:[{id:"elementId",type:"html",html:"<div>"+"<style>"+".doksoft_select{width:100%;line-height:28px; min-height: 28px; height:31px;  border:1px solid #ccc; padding:3px; margin:0px;}"+".doksoft_select option[disabled]{color:#ccc;}"+".doksoft_radio,.doksoft_checkbox{vertical-align: baseline;display: inline;white-space: nowrap;}"+".doksoft_radio input,.doksoft_checkbox input{float: left;margin-left: -20px;}"+"</style>"+'<table style="width:100%;">'+"<tr>"+'<td style="padding:5px 0px;">'+"<strong>"+s.lang.doksoft_translater.direction+"</strong>"+"</td>"+'<td style="padding:5px 15px;">'+"<strong>"+s.lang.doksoft_translater.service+"</strong>"+"</td>"+"</tr>"+'<tr style="padding-bottom:15px;">'+'<td style="width:450px;vertical-align:top;">'+'<table style="width:100%;">'+"<tr>"+'<td style="width:45%;vertical-align:middle;">'+'<select class="doksoft_select" id="doksoft_translate_from"></select>'+"</td>"+'<td style="text-align:center;vertical-align:middle;"><img onclick="var from = document.getElementById(\'doksoft_translate_from\'),to = document.getElementById(\'doksoft_translate_to\'), buf = from.value;from.value = to.value; to.value = buf; from.onchange.apply(from);" style="verticla-align:middle;" src="'+CKEDITOR.basePath+"plugins/doksoft_translater/icons/reverse.png"+'"/></td>'+'<td style="width:45%;vertical-align:middle;"><select class="doksoft_select" id="doksoft_translate_to"></select></td>'+"</tr>"+"</table>"+"</td>"+'<td style="vertical-align:top;padding-left:35px;padding-bottom:15px;">'+'<div class="control-group">'+'<div class="controls">'+'<label class="radio doksoft_radio"><input '+((!m._.doksoft_service||m._.doksoft_service=="yandex")?"checked":"")+' type="radio" value="yandex" name="doksoft_service" id="doksoft_service1"/>'+s.lang.doksoft_translater.yandex_translate_api+"</label><br/>"+'<label class="radio doksoft_radio"><input '+((m._.doksoft_service=="bing")?"checked":"")+' type="radio"  '+' value="bing" id="doksoft_service2" name="doksoft_service"/>'+s.lang.doksoft_translater.bing_translate_api+"</label><br/>"+'<label class="radio doksoft_radio"><input '+((m._.doksoft_service=="google")?"checked":"")+' type="radio" '+' value="google" id="doksoft_service3" name="doksoft_service"/>'+s.lang.doksoft_translater.google_translate_api+"</label>"+"</div>"+"</div>"+"</td>"+"</tr>"+"<tr>"+'<td style="padding:5px 0px;">'+"<strong>"+s.lang.doksoft_translater.assign_hotkeys+"</strong>"+"</td>"+'<td style="padding:5px 15px;">'+"<strong>"+s.lang.doksoft_translater.what_to_do+"</strong>"+"</td>"+"</tr>"+"<tr>"+'<td style="vertical-align:top;">'+'<table style="width:100%;">'+"<tr>"+'<td style="width:45%;">'+'<select  class="doksoft_select" id="doksoft_translate_keycode_one">'+(function(){var t=[];
for(var u in d[0]){t.push('<option value="'+d[0][u]+'">'+u+"</option>");}return t.join("");})()+"</select>"+"</td>"+'<td style="text-align:center;vertical-align:middle;font-size:2.0em;font-weight:700;">+</td>'+'<td style="width:45%;">'+'<select class="doksoft_select" id="doksoft_translate_keycode_two">'+(function(){var t=[],v=document.createElement("div");for(var u in d[1]){v.innerHTML=u;t.push('<option value="'+d[1][u]+'">'+v.innerHTML+"</option>");}return t.join("");})()+"</select>"+"</td>"+"</tr>"+"</table>"+"</td>"+'<td style="vertical-align:top;padding-left:35px;padding-bottom:15px;">'+'<div class="control-group">'+'<div class="controls">'+'<label class="radio doksoft_radio"><input '+((!m._.doksoft_ontranslate||m._.doksoft_ontranslate=="replace")?"checked":"")+' type="radio" name="doksoft_ontranslate" id="doksoft_ontranslate1" value="replace"/>'+s.lang.doksoft_translater.inline_replace+"</label><br/>"+'<label class="radio doksoft_radio"><input '+((m._.doksoft_ontranslate=="append")?"checked":"")+' type="radio" name="doksoft_ontranslate" id="doksoft_ontranslate2" value="append"/>'+s.lang.doksoft_translater.inline_append+"</label><br/>"+'<label class="radio doksoft_radio"><input '+((m._.doksoft_ontranslate=="dialog")?"checked":"")+' type="radio" name="doksoft_ontranslate" id="doksoft_ontranslate3" value="dialog"/>'+s.lang.doksoft_translater.show_dialog+"</label><br/>"+"</div>"+"</div>"+"</td>"+"</tr>"+"</table>"+"</div>",}]}],buttons:[CKEDITOR.dialog.okButton],onLoad:function(){var z=document.getElementById("doksoft_translate_from"),y=document.getElementById("doksoft_translate_to"),t={},w={},x="";z.vars={};z.reverse=y;y.reverse=z;y.vars={};for(var v in m._.doksoft_direction_support[m._.doksoft_service]){x=m._.doksoft_direction_support[m._.doksoft_service][v].split("-");if(!z.vars[x[0]]){z.vars[x[0]]=[];}if(!y.vars[x[1]]){y.vars[x[1]]=[];}z.vars[x[0]].push(x[1]);y.vars[x[1]].push(x[0]);}for(x in z.vars){var u=document.createElement("option");u.value=x;u.innerHTML=s.lang.doksoft_translater.langs[x];if(x==(m._.doksoft_translater_default_from_language||"en")){u.setAttribute("selected",true);}z.appendChild(u);}for(x in y.vars){var u=document.createElement("option");u.value=x;if(x==(m._.doksoft_translater_default_to_language||"de")){u.setAttribute("selected",true);}u.innerHTML=s.lang.doksoft_translater.langs[x];y.appendChild(u);}z.onchange=function(){var D=this.value,B=this.reverse.childNodes,C="";for(var A=0;A<B.length;A++){if(B[A].style){B[A][(this.vars[D].indexOf(B[A].value)!==-1)?"removeAttribute":"setAttribute"]("disabled",true);}(this.vars[D].indexOf(B[A].value)!==-1&&C=="")&&(C=B[A].value);}if(this.vars[this.value].indexOf(this.reverse.value)===-1){this.reverse.value=C;}m._[this.id.replace("translate_","translater_default_")+"_language"]=this.value;m._[this.reverse.id.replace("translate_","translater_default_")+"_language"]=this.reverse.value;s.fire("doksoft_translate_update");s.fire("updateSettings");};y.onchange=function(){m._[this.id.replace("translate_","translater_default_")+"_language"]=this.value;s.fire("updateSettings");};z.onchange.apply(z);document.getElementById("doksoft_ontranslate1").onclick=document.getElementById("doksoft_ontranslate2").onclick=document.getElementById("doksoft_ontranslate3").onclick=function(){m._.doksoft_ontranslate=this.value;s.fire("updateSettings");};document.getElementById("doksoft_service1").onclick=document.getElementById("doksoft_service2").onclick=document.getElementById("doksoft_service3").onclick=function(){m._.doksoft_service=this.value;s.fire("updateSettings");};document.getElementById("doksoft_translate_keycode_one").onchange=document.getElementById("doksoft_translate_keycode_two").onchange=function(){if(m._.doksoft_hotkeys){delete s.keystrokeHandler.keystrokes[m._.doksoft_hotkeys];}m._.doksoft_hotkeys=parseInt(document.getElementById("doksoft_translate_keycode_one").value)+parseInt(document.getElementById("doksoft_translate_keycode_two").value);s.fire("updateSettings");s.keystrokeHandler.keystrokes[m._.doksoft_hotkeys]="doksoft_translater";};},onShow:function(){var v=document.getElementById("doksoft_translate_from");v.value=m._.doksoft_translater_default_from_language;document.getElementById("doksoft_translate_to").value=m._.doksoft_translater_default_to_language;v.onchange.apply(v);var u=document.getElementById("doksoft_translate_keycode_one").childNodes;for(var t=0;t<u.length;t++){if((m._.doksoft_hotkeys-parseInt(u[t].value))<256&&(m._.doksoft_hotkeys-parseInt(u[t].value))>=0){document.getElementById("doksoft_translate_keycode_one").value=parseInt(u[t].value);document.getElementById("doksoft_translate_keycode_two").value=m._.doksoft_hotkeys-parseInt(u[t].value);break;}}},onOk:function(){},};});e.addCommand("doksoft_translater_settings",new CKEDITOR.dialogCommand("doksoft_translater"));var q=function(x,u){for(var v=0,y=u.length,t=x.length;v<y&&v<t;v++){/[А-ЯЁA-Z]/.test(u.substr(v,1))&&(x=x.substr(0,v-1)+x.substr(v,1).toUpperCase()+x.substr(v+1));}return x;};
var c=function(s,t,u){s.setStart(s.startContainer,s.startOffset);s.setEnd(s.startContainer,s.endOffset+1);s.deleteContents();var v=new CKEDITOR.dom.text(q(t,u));s.insertNode(v);s.collapse(false);e.getSelection().selectRanges([s]);e.fire("saveSnapshot");};var j=function(s,t,u){s.setStart(s.startContainer,s.endOffset+1);s.setEnd(s.startContainer,s.endOffset+1);var v=new CKEDITOR.dom.text(" "+q(t,u));s.insertNode(v);s.collapse(false);e.getSelection().selectRanges([s]);e.fire("saveSnapshot");};var p=/[\s\t\r\n,\.\!\?\/\\\[\]\(\)><\*:;\#\@\%"'\+]/g;var b=function(u){h=e.getSelection();n=h.getRanges()[0];if(n.startContainer.type==CKEDITOR.NODE_TEXT){var y=n.startContainer.getText(),t=n.startOffset,s=n.endOffset-1;for(;t>0;t--){if(p.test(y.substr(t,1))){t++;break;}}n.startOffset=t;for(;s<y.length-1;s++){if(p.test(y.substr(s,1))){s--;break;}}n.endOffset=s;k=y.substring(t,s+1).replace(p," ");var w=0,x;var v=function(z){if(z.code==200){e.fire("saveSnapshot");switch(m._.doksoft_ontranslate){case"replace":c(n,o=z.text[0],k);break;case"append":j(n,o=z.text[0],k);break;case"dialog":alert_dialog=e.openDialog("doksoft_translater_alert");alert_dialog.getContentElement("tab22","elementId").getElement().setHtml(q(o=z.text[0],k));break;}}};if(k.length>3){switch(m._.doksoft_service){case"yandex":JSONP("https://translate.yandex.net/api/v1.5/tr.json/translate?key="+(m._.doksoft_yandex_key||"")+"&lang="+m._.doksoft_translater_default_from_language+"-"+m._.doksoft_translater_default_to_language+"&text="+encodeURIComponent(k)+"&callback",v);break;case"bing":JSONP("https://api.microsofttranslator.com/V2/Ajax.svc/Translate?appId="+encodeURIComponent("Bearer "+f)+"&from="+m._.doksoft_translater_default_from_language+"&to="+m._.doksoft_translater_default_to_language+"&text="+encodeURIComponent(k)+"&oncomplete",function(z){v({code:200,text:[z]});});break;case"google":JSONP(CKEDITOR.basePath+"plugins/doksoft_translater/google.php?keycode="+m._.doksoft_keycode+"&from="+m._.doksoft_translater_default_from_language+"&to="+m._.doksoft_translater_default_to_language+"&text="+encodeURIComponent(k)+"&callback",v);break;}}}};if(e.contextMenu){e.addMenuGroup("doksoft_group");e.addMenuItem("doksoft_translater",{label:e.lang.doksoft_translater.translate,command:"doksoft_translater",group:"doksoft_group"});e.contextMenu.addListener(function(s,t){n=t.getRanges()[0];if(n.startContainer.type==CKEDITOR.NODE_TEXT||n.startContainer.type==CKEDITOR.NODE_ELEMENT){return{doksoft_translater:CKEDITOR.TRISTATE_OFF};}});}e.addCommand("doksoft_translater",{exec:function(){b(e.getSelection());}});e.addCommand("doksoft_translater_reverse",{exec:function(){var s=m._.doksoft_translater_default_from_language;m._.doksoft_translater_default_from_language=m._.doksoft_translater_default_to_language;m._.doksoft_translater_default_to_language=s;e.fire("doksoft_translate_update");e.fire("updateSettings");}});e.ui.addButton("doksoft_translater",{title:e.lang.doksoft_translater.translate,command:"doksoft_translater",group:"doksoft_translater",state:CKEDITOR.TRISTATE_DISABLED,icon:this.path+"icons/doksoft_translater.png"});e.ui.addButton("doksoft_translater_settings",{title:e.lang.doksoft_translater.translate_settings,command:"doksoft_translater_settings",group:"doksoft_translater",icon:this.path+"icons/doksoft_translater_settings.png"});e.ui.addButton("doksoft_translater_reverse",{title:e.lang.doksoft_translater.translate_reverse,command:"doksoft_translater_reverse",group:"doksoft_translater",icon:this.path+"icons/doksoft_translater_reverse.png"});var g=function(){if(e.mode!="wysiwyg"){return;}var s=e.getSelection().getRanges();e.ui.get("doksoft_translater").setState(s.length&&s[0].startContainer&&s[0].startContainer.type==CKEDITOR.NODE_TEXT?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED);};e.on("selectionChange",function(s){g();});e.on("instanceReady",function(){var t=document.getElementById(e.ui.get("doksoft_translater_reverse")._.id).childNodes[0];t.style.position="relative";var u=[document.createElement("div"),document.createElement("div")];for(var s=0;s<2;++s){u[s].style.position="absolute";u[s].style.fontSize="9px";u[s].style.fontWeight="normal";u[s].style.cursor="default";if(s==1){u[s].style.right="0";u[s].style.bottom="1px";u[s].style.color="white";}else{u[s].style.left="1px";u[s].style.top="-1px";}t.appendChild(u[s]);}e.on("doksoft_translate_update",function(){u[0].innerHTML=m._.doksoft_translater_default_from_language;u[1].innerHTML=m._.doksoft_translater_default_to_language;});e.fire("doksoft_translate_update");});e.on("contentDom",function(){var s=0;e.editable().attachListener(CKEDITOR.env.ie?e.editable():e.document.getDocumentElement(),"mouseup",function(){s=setTimeout(function(){g();},0);});e.on("destroy",function(){clearTimeout(s);});e.editable().on("keyup",g);});if(m._.doksoft_hotkeys){e.keystrokeHandler.keystrokes[m._.doksoft_hotkeys]="doksoft_translater";}}});