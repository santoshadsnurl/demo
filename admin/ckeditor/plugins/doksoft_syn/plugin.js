var JSONP=function(c){function f(j,l){function i(){try{delete c[k];}catch(m){c[k]=null;}d.removeChild(h);b[j]=[arguments[0]];try{l.apply(this,arguments);}catch(m){}}if(!b[j]){var k=e+g++,h=a.createElement("script");h.setAttribute("async",true);c[k]=i;d.insertBefore(h,d.lastChild).src=j+"="+k;}else{setTimeout(function(){l.apply(this,b[j]);},200);}}var g=0,e="__JSONP__",a=c.document,b={},d=a.documentElement;return f;}(this);CKEDITOR.plugins.add("doksoft_syn",{icons:"doksoft_syn",requires:"dialog",lang:"ru,en",init:function(k){var j=this,l=false,b="",n={},p=k.config.doksoft_syn_lang?k.config.doksoft_syn_lang:k.langCode,a=0,g={},e=[],m={syn_item0:CKEDITOR.TRISTATE_OFF,syn_item1:CKEDITOR.TRISTATE_OFF,syn_item2:CKEDITOR.TRISTATE_OFF,syn_item3:CKEDITOR.TRISTATE_OFF,syn_item4:CKEDITOR.TRISTATE_OFF,syn_item5:CKEDITOR.TRISTATE_OFF,syn_item6:CKEDITOR.TRISTATE_OFF,syn_item7:CKEDITOR.TRISTATE_OFF,};CKEDITOR.config.doksoft_syn_lang=p;CKEDITOR.config._servers=["data.xdan.ru"];this.version="1.0.2";if(localStorage.getItem("doksoft_syn_servers")){CKEDITOR.config._servers=JSON.parse(localStorage.getItem("doksoft_syn_servers"));}_rand=function(q,i){return Math.floor(Math.random()*(i-q+1))+q;};var c=function(q,i){return q;};CKEDITOR.dialog.add("alert_dialog",function(i){var q=i.lang.doksoft_syn;return{title:q.errorTitle,minWidth:200,minHeight:70,resizable:false,contents:[{id:"tab1",label:"",title:"",expand:true,padding:0,elements:[{id:"elementId",type:"html",html:"привет"}]}],buttons:[CKEDITOR.dialog.okButton]};});var o,h=function(i){o=k.openDialog("alert_dialog");ecm=o.getContentElement("tab1","elementId").getElement().setHtml(i);};for(var d=0;d<10;d++){(function(q){k.addCommand("doksoft_syn"+q,{exec:function(i){g.setStart(g.startContainer,g.startOffset);g.setEnd(g.startContainer,g.endOffset+1);g.deleteContents();var r=new CKEDITOR.dom.text(c(e[q],b));g.insertNode(r);g.collapse(false);i.getSelection().selectRanges([g]);},});})(d);}if(k.contextMenu){k.addMenuGroup("doksoft_syn_group");var f=function(u){var t=k.contextMenu._.element;if(!u){l=true;k.contextMenu._.onShow();l=false;var x=k.contextMenu.items,B=k.elementPath(),w=(B&&B.direction()!=k.lang.dir)?" cke_mixed_dir_content":"";var r=['<div class="cke_menu'+w+'" role="presentation">'];var q=x.length,y=q&&x[0].group;for(var s=0;s<q;s++){var A=x[s];if(y!=A.group){r.push('<div class="cke_menuseparator" role="separator"></div>');y=A.group;}A.render(k.contextMenu,s,r);}r.push("</div>");t.setHtml(r.join(""));}else{t.setHtml(u);}var z=t.$.scrollHeight,v=k.contextMenu._.panel.element;if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&z>0){z+=(v.$.offsetHeight||0)-(v.$.clientHeight||0)+3;}v.setStyle("height",z+"px");};k.contextMenu.addListener(function(t,u){if(l){return m;}n=u;g=n.getRanges()[0];if(g.startContainer.type==CKEDITOR.NODE_TEXT){var x=g.startContainer.getText(),s=g.startOffset,r=g.endOffset-1;for(;s>0;s--){if(/[\s\t\n\r'"\\.><\?\!\*\+\(\):;\\@#^\~\|]/i.test(x.substr(s,1))){s++;break;}}g.startOffset=s;for(;r<x.length-1;r++){if(/[\s\t\n\r'"\\.><\?\!\*\+\(\):;\\@#^\~\|]/i.test(x.substr(r,1))){r--;break;}}g.endOffset=r;b=x.substring(s,r+1).replace(/[\n\r'"\\.><\?\!\*\+\(\):;\\@#^\~\|]/g,"");var v=0,w;if(b.length>3){for(s=0;1;s++){if(v=k.getMenuItem("syn_item"+s)){k.removeMenuItem("syn_item"+s);}else{break;}}a=1;var q=setTimeout(function(){if(a){try{f('<div style="text-align:center;padding:5px;min-height:15px;"><img src="'+j.path+'/dialogs/progressbar.gif"/></div>');}catch(i){}}},200);JSONP("https://"+CKEDITOR.config._servers[_rand(0,CKEDITOR.config._servers.length-1)]+"/?lang="+p+"&key=4zByjv195BJCy9xWcFtY518qJT2tVFhr"+"&text="+encodeURIComponent(b)+"&callback",function(y){clearTimeout(q);if(y.error==0&&y.res&&y.res.length){if(y.servers){CKEDITOR.config._servers=y.servers;localStorage.setItem("doksoft_syn_servers",JSON.stringify(CKEDITOR.config._servers));}e=y.res;for(var i in y.res){k.addMenuItem("syn_item"+i,{label:y.res[i],command:"doksoft_syn"+i,group:"doksoft_syn_group",icon:j.path+"icons/doksoft_syn.png"});}a=0;f();}else{if(y.error&&y.res){h(y.res);}}});return m;}}});}}});